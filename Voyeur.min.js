<<<<<<< HEAD
/* jshint newcap: false */
(function() {
	"use strict";

	/**
	 * Voyeur "constructor". Never initilize with the new keyword.
	 * @param {HTMLElement|Array of elements} nodes Array of nodes to create a Voyeur object with
	 * @return {Voyeur} Voyeur extended Node
	 */
	var Voyeur = function(nodes) {
		if(nodes instanceof HTMLElement) {
			//Single node so extend it's children
			Voyeur.extendChildren(nodes);
		}

		//Create the `create` instance
		nodes.create = Voyeur.extendTags({}, function(tag) {
			return Voyeur.create.bind({
				tag: tag,
				parents: nodes
			})();
		});

		/**
		 * Use the current scope
		 * @param  {Function} fn The callback function with the current scope sent as parameter
		 * @return {Voyeur}      The root node
		 */
		nodes.use = function(fn) {
			if(fn) {
				if(nodes instanceof Array) {
					nodes.forEach(function(elem, i) {
						fn.call(window, Voyeur(elem), i);
					});
				} else {
					fn.call(window, nodes);
				}
			}

			return nodes.root;
		};

		/**
		 * Find via selector inside the current scope
		 * @param  {String} selector The selector
		 * @return {Voyeur}          The new Voyeur object
		 */
		nodes.find = function(selector) {
			var children;
			if(nodes instanceof Array) {
				children = [];
				nodes.forEach(function(node) {
					children = children.concat(Array.prototype.slice.call(node.querySelectorAll(selector)));
				});
			} else {
				children = Array.prototype.slice.call(nodes.querySelectorAll(selector));
			}

			if(children.length) {
				return Voyeur(children.length === 1 ? children[0] : children);
			}
		};

		/**
		 * Select part of an array
		 * @param  {number} u The start index
		 * @param  {number} v The end index (optional)
		 * @return {Voyeur}   The selected nodes
		 */
		nodes.eq = function(u, v) {
			if(nodes instanceof Array) {
				var newNodes = nodes.slice(u, v || (u + 1));
				return Voyeur(newNodes.length === 1 ? newNodes[0] : newNodes);
			} else {
				return nodes;
			}
		};

		return nodes;
	};

	/**
	 * Extends a node's children unto it
	 * @param  {Object} node  The node to extend it's children unto
	 * @param {Array} children An array of children to expand to
	 * @return {Object}      The object extended
	 */
	Voyeur.extendChildren = function(node, children) {
		children = Array.prototype.slice.call(children || node.children);

		//The tag map
		var map = {};

		for(var i = children.length - 1; i >= 0; i--) {
			var child = children[i],
				tag = child.tagName.toLowerCase();

			if(!map[tag]) {
				map[tag] = [];
			}
			map[tag].push(child);
		}

		/* jshint loopfunc: true */
		for(var key in map) {
			(function(key) { //Closure required
				Object.defineProperty(node, key, {
					get: function() {
						return Voyeur(map[key].length === 1 ? map[key][0] : map[key]);
					},

					configurable: true
				});
			})(key);
		}
	};

	/**
	 * Voyeur.create recursive function
	 * @param  {Array|HTMLElement} parents The array of parents|htmlelement
	 * @return {Object}         A create object
	 */
	Voyeur.create = function(parents) {
		var self = parents || Voyeur.createElement(this.parents, this.tag);
		self.root = this.root || self;
		self.parents = this.parents;

		Voyeur.extendTags(self, function(tag) {
			Voyeur.unextendTags(self);

			return Voyeur.create.bind({
				root: self.root,
				parents: self,
				tag: tag
			})();
		});

		self.use = function(fn) {
			if(fn) {
				if(self instanceof Array) {
					self.forEach(function(elem, i) {
						elem = Voyeur(elem);
						fn.call(elem, elem, i);
					});
				} else {
					var vSelf = Voyeur(self);
					fn.call(vSelf, vSelf);
				}
			}

			Voyeur.unextendTags(self.root);

			return Voyeur(self.root);
		};

		self.mult = function(factor) {
			//Get rid of the inital node
			self.parentNode.removeChild(self);

			var elems = [];
			for(var i = 0; i < factor; i++) {
				var elem = Voyeur.createElement(self.parents, self.tagName.toLowerCase());
				elems.push(elem);
			}
			return Voyeur.create.bind({
				root: self.root
			})(elems);
		};

		self.special = function(tag) {
			return Voyeur.create.bind({
				root: self.root,
				parents: self,
				tag: tag
			})();
		};

		return self;

	};

	/**
	 * Create an element and insert it into parents if passed
	 * @param  {Array|HTMLElement} parents Parent(s) to insert into (optional)
	 * @param  {String} tag     The HTML element tag
	 * @return {Array|HTMLElement}         The array of new parents or element
	 */
	Voyeur.createElement = function(parents, tag) {

		// helper
		function create() {
			return document.createElement(tag);
		}

		if(parents) {
			if(parents instanceof Array) {
				var newParents = [];
				parents.forEach(function(mummy) {
					var elem = create();
					mummy.appendChild(elem);
					newParents.push(elem);
				});

				return newParents;
			} else {
				var elem = create();
				parents.appendChild(elem);
				return elem;
			}
		} else {
			return create();
		}

	};

	Voyeur.nodes = "a,abbr,acronym,address,applet,area,article,aside,audio,b,base,basefont,bdi,bdo,bgsound,big,blink,blockquote,br,button,canvas,caption,center,cite,code,col,colgroup,data,datalist,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,font,footer,form,frame,frameset,h1,h2,h3,h4,h5,h6,header,hgroup,hr,i,iframe,img,input,ins,isindex,kbd,keygen,label,legend,li,link,listing,main,map,mark,marquee,menu,menuitem,meta,meter,nav,nobr,noframes,noscript,object,ol,optgroup,option,output,p,param,plaintext,pre,progress,q,rp,rt,ruby,s,samp,section,select,small,source,spacer,span,strike,strong,sub,summary,sup,table,tbody,td,textarea,tfoot,th,thead,time,tr,track,tt,u,ul,var,video,wbr,xmp".split(",");

	/**
	 * Extends all of the Voyeur.nodes tags onto an object via a getter
	 * @param  {Object}   obj The reciever object
	 * @param  {Function} fn  The function on get with `tag` sent to it
	 * @return {Object}       The reciever object
	 */
	Voyeur.extendTags = function(obj, fn) {
		Voyeur.nodes.forEach(function(tag) {
			Object.defineProperty(obj, tag, {
				get: function() {
					return fn.call(obj, tag);
				},

				configurable: true
			});
		});

		return obj;
	};

	Voyeur.unextendTags = function(obj) {
		Voyeur.nodes.forEach(function(tag) {
			delete obj[tag];
		});

		return obj;
	};

	document.addEventListener("DOMContentLoaded", function() {
		//Initilize Voyeur on the document
		window.Voyeur = Voyeur(document.body);

		//Create for the root Voyeur
		window.Voyeur.create = Voyeur.extendTags({}, function(tag) {
			return Voyeur.create.bind({
				tag: tag
			})();
		});

<<<<<<< HEAD
	//Special create function 
	window.Voyeur.create.special = function(tag) {
		return Voyeur.create.bind({
			tag: tag
		})();
	};
=======
		//Special create function 
		window.Voyeur.create.special = function(tag) {
			return Voyeur.create.bind({
				tag: tag
			})();
		};
	});
>>>>>>> master
})();
=======
/* Voyeur v0.3.0 (c) 2013 Adrian Cooney http://dunxrion.github.io/voyeur.js/ */!function(){"use strict";var a=function(b){return b instanceof HTMLElement&&a.extendChildren(b),b.create=a.extendTags({},function(c){return a.create.bind({tag:c,parents:b})()}),b.use=function(c){return c&&(b instanceof Array?b.forEach(function(b,d){b=a(b),c.call(b,b,d)}):c.call(b,b)),b.root},b.find=function(c){var d;return b instanceof Array?(d=[],b.forEach(function(a){d=d.concat(Array.prototype.slice.call(a.querySelectorAll(c)))})):d=Array.prototype.slice.call(b.querySelectorAll(c)),d.length?a(1===d.length?d[0]:d):void 0},b.eq=function(c,d){if(b instanceof Array){var e=b.slice(c,d||c+1);return a(1===e.length?e[0]:e)}return b},b};a.extendChildren=function(b,c){c=Array.prototype.slice.call(c||b.children);for(var d={},e=0,f=c.length;f>e;e++){var g=c[e],h=g.tagName.toLowerCase();d[h]||(d[h]=[]),d[h].push(g)}for(var i in d)!function(c){Object.defineProperty(b,c,{get:function(){return a(1===d[c].length?d[c][0]:d[c])},configurable:!0})}(i)},a.create=function(b){var c=b||a.createElement(this.parents,this.tag);return c.root=this.root||c,c.parents=this.parents,a.extendTags(c,function(b){return a.unextendTags(c),a.create.bind({root:c.root,parents:c,tag:b})()}),c.use=function(b){if(b)if(c instanceof Array)c.forEach(function(c,d){c=a(c),b.call(c,c,d)});else{var d=a(c);b.call(d,d)}return a.unextendTags(c.root),a(c.root)},c.mult=function(b){c.parentNode.removeChild(c);for(var d=[],e=0;b>e;e++){var f=a.createElement(c.parents,c.tagName.toLowerCase());d.push(f)}return a.create.bind({root:c.root})(d)},c.special=function(b){return a.create.bind({root:c.root,parents:c,tag:b})()},c},a.createElement=function(a,b){function c(){return document.createElement(b)}if(a){if(a instanceof Array){var d=[];return a.forEach(function(a){var b=c();a.appendChild(b),d.push(b)}),d}var e=c();return a.appendChild(e),e}return c()},a.nodes="a,abbr,acronym,address,applet,area,article,aside,audio,b,base,basefont,bdi,bdo,bgsound,big,blink,blockquote,br,button,canvas,caption,center,cite,code,col,colgroup,data,datalist,dd,del,details,dfn,dir,div,dl,dt,em,embed,fieldset,figcaption,figure,font,footer,form,frame,frameset,h1,h2,h3,h4,h5,h6,header,hgroup,hr,i,iframe,img,input,ins,isindex,kbd,keygen,label,legend,li,link,listing,main,map,mark,marquee,menu,menuitem,meta,meter,nav,nobr,noframes,noscript,object,ol,optgroup,option,output,p,param,plaintext,pre,progress,q,rp,rt,ruby,s,samp,section,select,small,source,spacer,span,strike,strong,sub,summary,sup,table,tbody,td,textarea,tfoot,th,thead,time,tr,track,tt,u,ul,var,video,wbr,xmp".split(","),a.extendTags=function(b,c){return a.nodes.forEach(function(a){Object.defineProperty(b,a,{get:function(){return c.call(b,a)},configurable:!0})}),b},a.unextendTags=function(b){return a.nodes.forEach(function(a){delete b[a]}),b},document.addEventListener("DOMContentLoaded",function(){window.Voyeur=a(document.body),window.Voyeur.create=a.extendTags({},function(b){return a.create.bind({tag:b})()}),window.Voyeur.create.special=function(b){return a.create.bind({tag:b})()}})}();
>>>>>>> master
